# Network-Generator

A set of programs and helper programs related to generation of Purkinje networks. 

## Activation-Time

A program that study the classic cable equation. It can calculate not only propagation velocity, but also the activation time of a given point on a cable. The ``scripts`` folder contains a Python program that plots a visualization of the function.

**Reference**

Keener, James P., and James Sneyd. **Mathematical physiology. Vol. 1.** New York: Springer, 1998.

## Angle-Between-Vectors

A simple program that demonstrates how to calculate the angle between two vectors.

## Bifurcartion-Generator

A program that builds a fractal network. A general and more complete version of this program can be found on the ``fractal-network`` project.

## Cable-Equation

Another program that studies the cable equation. In this version, the study is done using cardiac cells parameters. The ``scripts`` folder contains a Python program that plots a visualization of the function. In addition, there are several scripts for running batch simulations for a sensibility analysis. 

## Cable-Theory

A Python script that check an another form of the cable equation. This study was based on the following paper:

**Reference**

SCHOENBERG, M. A. R. K.; DOMINGUEZ, GRACIELA; FOZZARD, HARRY A. **Effect of diameter on membrane capacity and conductance of sheep cardiac Purkinje fibers**. The Journal of general physiology, v. 65, n. 4, p. 441-458, 1975.

## CCO-Project (2D)

First version of the program that generates a Purkinje network based on the Constrained Constructive Optimization (CCO) algorithm. In special, this version only works with a 2D cloud of points, such as squares, circles and triangles. 

For a more complete and general version of this program check the ``cco-project-3d`` folder.   

**References**

SCHREINER, Wolfgang; BUXBAUM, Peter Franz. **Computer-optimization of vascular trees.** IEEE Transactions on Biomedical Engineering, v. 40, n. 5, p. 482-491, 1993.

KARCH, Rudolf et al. **A three-dimensional model for arterial tree representation, generated by constrained constructive optimization.** Computers in biology and medicine, v. 29, n. 1, p. 19-38, 1999.

## CCO-Project-3D

General version of the ``cco-project``, it enables the user to not only build a Purkinje network within a 3D cloud of points given in ``pts`` format, but also implements different cost functions to be used on the optimization section of the algorithm. For a better performance the cloud of points should be processed previously by the `point-remapper` program.

Furthermore, the user can specify if the Murray law for bifurcation must be satisfied or not. By default, the program will always attend the law, but for some particular cost functions where this restriction can be carried out, like on the *activation_time* function, the user must supply an initial diameter for the root segment.

There is also two new options for pos-processing the Purkinje network. Firtly, the user can specify a set of points that must be part of the final network. This process is normally used when the positions of the *Purkinje-Muscle-Junction* (PMJ) are known. Secondly, there is an option to configure a prune function, which will remove only terminal branches.

In this folder there is also a `scripts` folder, which can be use to transform the generated Purkinje network to a different domain, like for instance, the domain where a simulation from the ``MonoAlg3D_C`` is executed. 

Additionally, there is a script for sensibility analysis. It can generate all the configuration files that are necessary to run not only the ``cco-project-3d`` program with different inputs, but also the configuration files used by the ``MonoAlg3D_C`` using the generated networks. 

There is also a script which enables the animation of the growing process of the Purkinje. To fully use this feature, the program must be run on ``debug-mode`` and the Paraview software should be used to generate the frames. 

##### OBS:

There is some examples that will only work if a specific cloud points is supplied, like for example the patient-specific ones. To avoid copyright issues these clouds are not in this repository.

**References**

ULYSSES, Jesuliana N. et al. **An optimization-based algorithm for the construction of cardiac Purkinje network models.** IEEE Transactions on Biomedical Engineering, v. 65, n. 12, p. 2760-2768, 2018.

## CCO-Project-Electric

A variation from the original CCO algorithm, which tries to use electric parameters instead hidrodinamic ones. 

##### DISCLAIMER:

This project needs further improves, since some examples are not working properly.

## Collision-Detection

A simple program which can be use to identify collision between two segments. Additionally, a visualization of the segments is generated when using this binary and the output can be visualized inside Paraview.

**References**

O'ROURKE, Joseph et al. **Computational geometry in C**. Cambridge university press, 1998.

## Diffusion-Limited-Aggregation

This program uses the Diffusion-Limited-Aggregation (DLA) algorithm to build a Purkinje network over a mesh written in ``stl`` format. 

By default, a point-to-faces graph map is generated for each mesh, but to improve performance is recommended to run first the ``points-to-faces-mapping`` script, which will generate the map file required by the program to run more fast.

In the same way as the ``cco-project-3d``, there are scripts for sensibility analysis, to transform the generated network into the domain used by the ``MonoAlg3D_C`` solver and to animate the growing process.

**References**

OFFRINGA, Andr√©. **Diffusion Limited Aggregation.** 2014.

JULLIEN, R.; KOLB, M.; BOTET, R. **Diffusion limited aggregation with directed and anisotropic diffusion.** Journal de Physique, v. 45, n. 3, p. 395-399, 1984.

## Distance-Criterion

A simple program that was used to understand the distance criterion procedure necessary to build the CCO algorithm.

## Duplicate-Points

Program that receive a Purkinje network written in ``vtk`` format and returns the duplicate points on it.

## Filter-Files

Program that will open a specific folder and stores all the files which are from a given extension in a ``vector``. 

## Fractal-Network

Program that generates a 2D Purkinje network following a simple binary fractal rule. One feature of this program is that the user can not only define the number of growing iterations, but also set an initial length, diameter and angle for the segments. 

Furthermore, the values from these parameters can be altered based on a ``decrease_ratio`` value, which can also be set on the input configuration file.

## Generate-Cloud-Points

First version of the program that generates the cloud of points used on the examples from the ``cco-project`` program. This version only generates 2D cloud of points, such as squares, circles and triangles. 

For a more complete and general version of this program check the ``generate-cloud-points-3d`` folder.

## Generate-Cloud-Points-3D

This is the general version program to generate the 3D cloud of points used on some examples from the ``cco-project-3d``. It is possible to generate hexaedron, sphere, squares and paraboloids clouds using different configurations.

The generated cloud is outputted both in ``pts`` and ``vtk`` format.

## Graph-Library

A graph library implementation using adjacency lists.

## Isoparametric-Mapping

A program that implements the isoparametric mapping used in the local optimization section of the CCO algorithm.

## Linked-List

A linked-list library implementation.

## Murray-Law

A program that explores the Murray law parameters.

## Network-Generator

Program that generates Purkinje network using the L-System algorithm.

**References**

Ijiri, Takashi, et al. **A procedural method for modeling the purkinje fibers of the heart.** The journal of physiological sciences (2008): 0810170079-0810170079.

## Network-Reader

Program that receives a Purkinje network in ``vtk`` format and returns several informations about its structure.

## Normal-Distribution

Program that implements a Random Number Generator using Normal Distribution in C++.

## Old-Codes

A set of old projects:

    * Point-Remapper-v1
    * Point-Remapper-v2
    * CCO-Project-v1

## Perfusion-Area

Program that draws the perfusion area used by the CCO algorithm.

## Point-Remapper

Program that receives a cloud of points and remap them using a root point as a reference. In this version the remapping is done directly in this code without using the "points-to-faces-mapping" program. First of all, the STL file with the mesh that will have the points remapped is loaded in memory with its points and faces.

Secondly, the link between the points and faces is done by only using the points and faces from the STL without building a map, as it was done in the previous version of the program. With the links configured, the next step is to build the mapping graph, which will store the indexes of the neighbour points from each point in the grid.

Lastly, a Breadth-First-Search (BFS) is performed from the root point index given as input argument. The points will be remapped following the search procedure.

## Progress-Bar

A simple program that prints out a progress bar on the screen.

## Segment-Plane

Program that identifies a segment-plane collision.

## Segment-Segment

Program that identifies a segment-segment collision.

## Segment-Triangle

Program that identifies a segment-triangle collision.

## Sorting-Points

Program that reads a set of points and sort them first by their ``x`` coordinate, them by their `y` coordinate and finally its `z` coordinate.

## Space-Colonization

Program that generates a Purkinje network over a cloud of points written in `pts` format by employing the Space Colonization algorithm.

**Reference**

RUNIONS, Adam; LANE, Brendan; PRUSINKIEWICZ, Przemyslaw. **Modeling Trees with a Space Colonization Algorithm.** NPH, v. 7, p. 63-70, 2007.

## STL-Reader

A library that can read and retrieve information from a ``stl`` file.

## Surface-Extractor

Program that can read a ``stl`` mesh surface and extract its surfaces.

## VTK-Point-Extractor

Program that reads a ``vtk`` file, extracts its points and dumps the result on a ``pts``.